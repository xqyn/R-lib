<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Smoothing</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for smooth {MsCoreUtils}"><tr><td>smooth {MsCoreUtils}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Smoothing</h2>

<h3>Description</h3>

<p>This function smoothes a numeric vector.
</p>


<h3>Usage</h3>

<pre>
smooth(x, cf)

coefMA(hws)

coefWMA(hws)

coefSG(hws, k = 3L)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p><code>numeric</code>, i.e. m/z values.</p>
</td></tr>
<tr valign="top"><td><code>cf</code></td>
<td>
<p><code>matrix</code>, a coefficient matrix generated by <code>coefMA</code>, <code>coefWMA</code> or
<code>coefSG</code>.</p>
</td></tr>
<tr valign="top"><td><code>hws</code></td>
<td>
<p><code>integer(1)</code>, half window size, the resulting window reaches from
<code>(i - hws):(i + hws)</code>.</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p><code>integer(1)</code>, set the order of the polynomial used to calculate the
coefficients.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the Savitzky-Golay-Filter the <code>hws</code> should be smaller than
<em>FWHM</em> of the peaks (full width at half maximum; please find details in
Bromba and Ziegler 1981).
</p>
<p>In general the <code>hws</code> for the (weighted) moving average (<code>coefMA</code>/<code>coefWMA</code>)
has to bemuch smaller than for the Savitzky-Golay-Filter to conserve the
peak shape.
</p>


<h3>Value</h3>

<p><code>smooth</code>: A <code>numeric</code> of the same length as <code>x</code>.
</p>
<p><code>coefMA</code>: A <code>matrix</code> with coefficients for a simple moving average.
</p>
<p><code>coefWMA</code>: A <code>matrix</code> with coefficients for a weighted moving average.
</p>
<p><code>coefSG</code>: A <code>matrix</code> with <em>Savitzky-Golay-Filter</em> coefficients.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>coefMA</code>: Simple Moving Average
</p>
<p>This function calculates the coefficients for a simple moving average.
</p>
</li>
<li> <p><code>coefWMA</code>: Weighted Moving Average
</p>
<p>This function calculates the coefficients for a weighted moving average with
weights depending on the distance from the center calculated as
<code>1/2^abs(-hws:hws)</code> with the sum of all weigths normalized to 1.
</p>
</li>
<li> <p><code>coefSG</code>: Savitzky-Golay-Filter
</p>
<p>This function calculates the Savitzky-Golay-Coefficients. The additional
argument <code>k</code> controls the order of the used polynomial. If <code>k</code> is set to zero
it yield a simple moving average.
</p>
</li></ul>


<h3>Note</h3>

<p>The <code>hws</code> depends on the used method ((weighted) moving
average/Savitzky-Golay).
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb, Sigurdur Smarason (weighted moving average)
</p>


<h3>References</h3>

<p>A. Savitzky and M. J. Golay. 1964.
Smoothing and differentiation of data by simplified least squares procedures.
Analytical chemistry, 36(8), 1627-1639.
</p>
<p>M. U. Bromba and H. Ziegler. 1981.
Application hints for Savitzky-Golay digital smoothing filters.
Analytical Chemistry, 53(11), 1583-1586.
</p>
<p>Implementation based on:
Steinier, J., Termonia, Y., &amp; Deltour, J. (1972). Comments on Smoothing and
differentiation of data by simplified least square procedure.
Analytical Chemistry, 44(11), 1906-1909.
</p>


<h3>See Also</h3>

<p>Other noise estimation and smoothing functions: 
<code><a href="../../MsCoreUtils/help/noise.html">noise</a>()</code>
</p>


<h3>Examples</h3>

<pre>
x &lt;- c(1:10, 9:1)
plot(x, type = "b", pch = 20)
cf &lt;- list(MovingAverage = coefMA(2),
           WeightedMovingAverage = coefWMA(2),
           SavitzkyGolay = coefSG(2))
for (i in seq_along(cf)) {
    lines(smooth(x, cf[[i]]), col = i + 1, pch = 20, type = "b")
}
legend("bottom", legend = c("x", names(cf)), pch = 20,
       col = seq_len(length(cf) + 1))
</pre>

<hr /><div style="text-align: center;">[Package <em>MsCoreUtils</em> version 1.4.0 <a href="00Index.html">Index</a>]</div>
</body></html>
